<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Table of Contents</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="pandoc.css" />
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Table of Contents</h1>
</header>
<!---
pandoc table-of-contents.md -o table-of-contents.html --css pandoc.css -s --mathjax --metadata title="Table of Contents" && open table-of-contents.html
-->
<ul>
<li>author: John A. Marohn</li>
<li>created: 2024-10-29</li>
<li>last updated: 2025-09-09</li>
</ul>
<p>In the <code>dissipationtheory/development</code> folder there are a
number of <em>studies</em> — Jupyter notebooks in which I experimented
with calculation and data-analysis code. The studies have names like
<code>dissipation-theory--Study-1.ipynb</code> and so forth. Here I
summarize these studies.</p>
<h1 id="studies">Studies</h1>
<ul>
<li><p><strong>Study 1</strong> (<a
href="dissipation-theory--Study-1.html">html</a>). Explore Loring’s
recently revised theory for friction over metals.</p></li>
<li><p><strong>Study 2</strong> (<a
href="dissipation-theory--Study-2.html">html</a>). Explore Lekkala and
Loring’s theory for friction over a semiconductor backed by a
metal.</p></li>
<li><p><strong>Study 3</strong> (<a
href="dissipation-theory--Study-3.html">html</a>). Try to reproduce
Figure 7(b) and Figure 9(b) from Lekkala2012.</p></li>
<li><p><strong>Study 4</strong> (<a
href="dissipation-theory--Study-4.html">html</a>). Look at ways to cut
down code redundancy in the code in Study 3 (<a
href="dissipation-theory--Study-3.html">html</a>). It would greatly
simplify my code if the sample object would update the diffusion length
automatically when the mobility or cantilever period was
updated.</p></li>
<li><p><strong>Study 5</strong> (<a
href="dissipation-theory--Study-5.html">html</a>). Look at ways to cut
down code redundancy in the code in Study 4 (<a
href="dissipation-theory--Study-4.html">html</a>).</p></li>
<li><p><strong>Study 6</strong> (<a
href="dissipation-theory--Study-6.html">html</a>). Reproduce the
friction <span class="math inline">\(\gamma_{\parallel}\)</span> versus
charge density <span class="math inline">\(\rho\)</span> plots in
Lekkala2013 Figure 7(b) using the functions in
<code>dissipationtheory.dissipation.py</code>. The computation is
carried out over 40 charge densities, for 4 charge mobilities, and using
Model I and Model II in the paper. The computation in done two ways – in
pure Python and in <code>numba</code>-compiled Python. The computation
takes approximately 2.4 min in pure Python and 0.6 s in
<code>numba</code>-compiled Python.</p></li>
<li><p><strong>Study 7</strong> (<a
href="dissipation-theory--Study-7.html">html</a>). A computation of
friction was carried out over 40 charge densities and 5 values of the
imaginary dielectric constant <span
class="math inline">\(\epsilon_{\mathrm{s}}^{\prime \prime}\)</span>,
using a <code>numba</code>-compiled Python version of Model II in the
paper. The computation takes less than a second.</p>
<p>In the paper, the tip-sample separation <span
class="math inline">\(d\)</span> was not specified. A first computation
was done with <span class="math inline">\(d = 300 \: \mathrm{\mu
m}\)</span>, but the agreement with Lekkala was poor. The tip-sample
separation was varied between 30 nm and 300 nm in 1 nm increments and
the sum-squared deviation <span class="math inline">\(\chi^2\)</span>
between the computed dissipation and Lekkala’s dissipation calculated
for the <span class="math inline">\(\epsilon_{\mathrm{s}}^{\prime
\prime} = 0\)</span> case. The <span
class="math inline">\(\chi^2\)</span> was minimized at an optimal
tip-sample separation of <span class="math inline">\(d_{\mathrm{opt}} =
101.0 \: \mathrm{nm}\)</span>. Computations performed with <span
class="math inline">\(d = d_{\mathrm{opt}}\)</span> were in very good
agreement with Lekkala over a range of <span
class="math inline">\(\epsilon_{\mathrm{s}}^{\prime \prime}\)</span>
values.</p>
<p>Instead of minimizing <span class="math inline">\(\chi^2\)</span>
using the <span
class="math inline">\(\epsilon_{\mathrm{s}}^{\prime\prime} = 0\)</span>
dataset, minimize it over all five data sets. Moreover, minimize the
relative error, not the absolute error. This gives all the curves equal
weight, even though they have quite different peak <span
class="math inline">\(\gamma_{\perp}\)</span> values. The <span
class="math inline">\(\chi^2\)</span> is now minimized at an optimal
tip-sample separation of <span class="math inline">\(d_{\mathrm{opt}} =
100.0 \: \mathrm{nm}\)</span>. Computations are are essentially
unchanged.</p></li>
<li><p><strong>Study 8</strong> (<a
href="dissipation-theory--Study-8.html">html</a>). Examine the unitless
0th and 1st derivatives of the sphere capacitance.</p></li>
<li><p><strong>Study 9</strong> (<a
href="dissipation-theory--Study-9.html">html</a>). Reproduce the
friction <span class="math inline">\(\gamma_{\perp}\)</span> versus
charge density <span class="math inline">\(\rho\)</span> plots in
Lekkala2013 Figure 9(b) using functions in
<code>dissipationtheory.dissipation.py</code>. Add in a low-density
approximation.</p></li>
<li><p><strong>Study 10</strong> (<a
href="dissipation-theory--Study-10.html">html</a>). Plot the friction
<span class="math inline">\(\gamma_{\perp}\)</span> versus height <span
class="math inline">\(h\)</span> expected for a thin organic
semiconductor sample backed by a metal.</p></li>
<li><p><strong>Study 11</strong> (<a
href="dissipation-theory--Study-11.html">html</a>). Calculate
dissipation versus height over a sample with properties similar to
Rachael’s PM6:Y6 and compare to Marohn’s analytical expression derived
in the thick-sample limit.</p></li>
<li><p><strong>Study 12</strong> (<a
href="dissipation-theory--Study-12.html">html</a>). Calculate
dissipation versus charge density for a representive perovskite
sample.</p></li>
<li><p><strong>Study 13</strong> (<a
href="dissipation-theory--Study-13.html">html</a>). Plot <span
class="math inline">\(a_{\mathrm{max}}\)</span> contours in the <span
class="math inline">\((\epsilon^{\prime}_{\mathrm{s}},
\epsilon^{\prime\prime}_{\mathrm{s}})\)</span> plane, keeping in mind
that <span
class="math inline">\(\epsilon^{\prime\prime}_{\mathrm{s}}\)</span> is
negative.</p></li>
<li><p><strong>Study 14</strong> (<a
href="dissipation-theory--Study-14.html">html</a>). Calculate
dissipation <span class="math inline">\(\gamma_{\perp}\)</span> versus
charge density <span class="math inline">\(\rho\)</span> for a
representive perovskite sample. Compare the exact result to the
low-density exapansion and an analytical expression for <span
class="math inline">\(\gamma_{\perp}^{\mathrm{max}}\)</span>. Both these
approximations are only valid in the infinite-sample limit, so use Model
2 with the dielectric overlayer thickness set to zero. Compare the
infinite-sample Model 2 result to a finite-sample Model 1 result, to
check the validity of the infinite-sample approximation used to obtain
an analytical result for the height dependence of the <span
class="math inline">\(\gamma_{\perp}\)</span>.</p></li>
<li><p><strong>Study 15</strong> (<a
href="dissipation-theory--Study-15.html">html</a>). Calculate
dissipation versus height over a sample with properties similar to
Rachael’s PM6:Y6 and compare to Marohn’s analytical expression derived
in the thick-sample limit. This notebook recalculates the successful fit
in Study 11 (<a href="dissipation-theory--Study-11.html">html</a>) and
further explores the result.</p></li>
<li><p><strong>Study 16</strong> (<a
href="dissipation-theory--Study-16.html">html</a>). Update the fits in
Study 15 (<a href="dissipation-theory--Study-15.html">html</a>) using a
slightly different consensus sample mobility.</p></li>
<li><p><strong>Study 17</strong> (<a
href="dissipation-theory--Study-17.html">html</a>). Test drive the new
BLDS code in <code>dissipationtheory.dissipation</code>.</p></li>
<li><p><strong>Study 18</strong> (<a
href="dissipation-theory--Study-18.html">html</a>). Test drive the new
LDS code in <code>dissipationtheory.dissipation</code>.</p></li>
<li><p><strong>Study 19</strong> (<a
href="dissipation-theory--Study-19.html">html</a>). Test drive the new
<code>BLDSData</code> object in
<code>dissipationtheory.data</code>.</p></li>
<li><p><strong>Study 20</strong> (<a
href="dissipation-theory--Study-20.html">html</a>). Explore how the BLDS
signal depends on mobility and charge density. Plot the <span
class="math inline">\(B^{(2)}(\omega_{\mathrm{m}}=0)\)</span> integral
versus charge density <span class="math inline">\(\rho\)</span>, for
selected dielectric constants. Generate a range of conductivities <span
class="math inline">\(\sigma_0\)</span> and compute the associated
roll-off frequency <span class="math inline">\(\omega_0 =
\sigma_0/\epsilon_0\)</span>. Plot the BLDS spectrum for various values
of the charge density <span class="math inline">\(\rho\)</span>, with
the mobility <span class="math inline">\(\mu\)</span> fixed. Plot the
low-frequency limit of the BLDS frequency shift versus the charge
density, with the mobility fixed.</p></li>
<li><p><strong>Study 21</strong> (<a
href="dissipation-theory--Study-21.html">html</a>). I have created a new
module, <code>dissipation2.py</code>, in which the semiconductor
properties are input in terms of conductivity and charge density instead
of mobility and charge density. Explore the new module.</p></li>
<li><p><strong>Study 22</strong> (<a
href="dissipation-theory--Study-22.html">html</a>). I have created a new
data-analysis module, <code>data2.py</code>, in which the BLDS spectrum
is fit to extact charge conductivity and charge density. Use the module
to analyze representative BLDS spectra. Fit representative PM6:Y6 BLDS
spectra.</p></li>
<li><p><strong>Study 23</strong> (<a
href="dissipation-theory--Study-23.html">html</a>). Plot cantilever
friction and BLDS signal versus conductivity and charge
density.</p></li>
<li><p><strong>Study 24</strong> (<a
href="dissipation-theory--Study-24.html">html</a>). Plot cantilever
friction versus conductivity, similar to Lekkala 203 Figures 7(b) and
9(b), but for (1) perpendicular friction and (2) plotted versus
conductivity and not charge density.</p></li>
<li><p><strong>Study 25</strong> (<a
href="dissipation-theory--Study-25.html">html</a>). For a chosen set of
cantilever and sample parameters, plot versus charge density <span
class="math inline">\(\rho\)</span> the</p>
<ul>
<li>low-frequency BLDS frequency shift <span
class="math inline">\(|\Delta f_{\mathrm{BLDS}}(0)|\)</span> and</li>
<li>cantilever friction <span
class="math inline">\(\gamma_{\mathrm{\perp}}\)</span>.</li>
</ul>
<p>Plot these quantities versus, respectively, the unitless
parameters</p>
<ul>
<li><span class="math inline">\((h/\lambda_{\mathrm{D}})^2\)</span>,
with <span class="math inline">\(h\)</span> the tip-sample separation
and <span class="math inline">\(\lambda_{\mathrm{D}}\)</span> the Debye
length, and</li>
<li><span class="math inline">\(\omega_0/(\epsilon_{\mathrm{s}}^{\prime}
\omega_{\mathrm{c}})\)</span>,</li>
</ul>
<p>with <span class="math inline">\(\omega_0 =
\sigma/\epsilon_0\)</span>, <span class="math inline">\(\sigma\)</span>
the conductivity, <span
class="math inline">\(\epsilon_{\mathrm{s}}^{\prime}\)</span> the real
part of the dielectric constant, and <span
class="math inline">\(\omega_{\mathrm{c}}\)</span> the cantilever
resonance frequency. Compare Marohn’s numerical calcualtions to Loring’s
low-density and high-density approximations for <span
class="math inline">\(|\Delta f_{\mathrm{BLDS}}(0)|\)</span>.</p></li>
<li><p><strong>Study 26</strong> (<a
href="dissipation-theory--Study-26.html">html</a>). Loring’s clear,
revised equations are writtien in terms of a new unitless integral <span
class="math inline">\(K\)</span>, not a correlation function <span
class="math inline">\(C\)</span> (Leakkala) or a response function <span
class="math inline">\(R\)</span> (Marohn). The code in
<code>dissipation.py</code> and <code>dissipation2.py</code> writes the
friction and BLDS frequency shift in terms of a correlation function
<span class="math inline">\(C\)</span> introduced in Leakkala’s 2013 JCP
paper. In <code>dissipation3.py</code> I rewrite the
<code>dissipation.py</code> code in terms of Loring’s unitless <span
class="math inline">\(K\)</span> integral, elimating extranneous factors
of <span class="math inline">\(k_{\mathrm{b}} T\)</span>. In
<code>dissipation3.py</code> I follow the convention of
<code>dissipation2.py</code>, where the sample’s dependent variables are
conductivity <span class="math inline">\(\sigma\)</span> and charge
denstiy <span class="math inline">\(\rho\)</span>, not the convention in
<code>dissipation.py</code>, where the sample’s dependent variable are
conductivity <span class="math inline">\(\sigma\)</span> and mobility
<span class="math inline">\(\mu\)</span>.</p></li>
<li><p><strong>Study 27</strong> (<a
href="dissipation-theory--Study-27.html">html</a>). The pure-Python
objects <code>CantileverModel</code>, <code>SampleModel1</code>, and
<code>SampleModel2</code> offer a better way to input simulation
parameters, because you can input parameters with units, but the
pure-Python computations are painfully show. Work out how to pass
parameters from <code>CantileverModel</code> to
<code>CantileverModelJit</code>, from <code>SampleModel1</code> to
<code>SampleModel1Jit</code>, and from <code>SampleModel2</code> to
<code>SampleModel2Jit</code>. We can now enter parameters using the
pure-Python objects, then transfer the parameters to the
<code>numba/jit</code> objects for fast computations.</p></li>
<li><p><strong>Study 28</strong> (<a
href="dissipation-theory--Study-28.html">html</a>). Redo Study 26 (<a
href="dissipation-theory--Study-26.html">html</a>) using
<code>numba/jit</code>-accelerated functions coded in
<code>dissipation3.py</code>. The <code>numba/jit</code> functions are
100 to 200 times faster than their pure-Python counterparts run in Study
26 (<a href="dissipation-theory--Study-26.html">html</a>), enabling us
to plot here a more detailed BLDS spectrum and explore friction and the
zero-frequency limit of the BLDS spectrum as a function of many more
conductivity points.</p></li>
<li><p><strong>Study 29</strong> (<a
href="dissipation-theory--Study-29.html">html</a>). I have rewritten the
code in <code>dissipation4.py</code> to require the user to explicitly
input the tip charge’s <span class="math inline">\(z\)</span> location.
In this notebook I test drive the new code. Check that, for an
“infinitely thick” sample, the BLDS frequency shift at <span
class="math inline">\(\omega_{\text{m}} = 0\)</span> agrees with
Loring’s <span class="math inline">\(\rho \rightarrow 0\)</span> and
<span class="math inline">\(\rho \rightarrow \infty\)</span> limiting
expressions. The numerical calculation of the low-frequency limit of the
BLDS spectrum agrees with the Loring’s expansions at both low denstity
and high density. To reach agreement, it is important that the sample be
very thick — 100 times the tip-sample separation.</p></li>
<li><p><strong>Study 30</strong> (<a
href="dissipation-theory--Study-30.html">html</a>). Compute the
capacitance of a sphere over a metal plane numerically using the method
outlined by Xu and co-workers. See Xu, J.; Li, J.; Li, W. Calculating
Electrostatic Interactions in Atomic Force Microscopy with Semiconductor
Samples. AIP Advances (2019) 9(10): 105308, <a
href="https://doi.org/10.1063/1.5110482">doi:10.1063/1.5110482</a>.</p></li>
<li><p><strong>Study 31</strong> (<a
href="dissipation-theory--Study-31.html">html</a>). Try to compute the
capacitance of a cone over a metal numerically, using the method
outlined by Xu and co-workers, cited above. Clean up the code in Study
30. To get a non-diverging charge distribution for the code, I had to
employ a large filtering factor. The voltage errors are significant, on
the order of five percent or more. The total charge on the cone is not a
sensitive function of the number of image-charge grid points.</p></li>
<li><p><strong>Study 32</strong> (<a
href="dissipation-theory--Study-32.html">html</a>). Compute the
capacitance of a sphere using the boundary point method, with 3200 and
12800 voltage-test points, and compare the calculated capacitance to the
expected result. The calculated capacitance gets larger, not smaller,
when the number voltage-test points is increased. I hypothesize that
this divergence is caused by using standard sphere parametrization,
where the area goes to zero at the poles. Using randomly-located charge
points, however, does not significantly improve the capacitance error;
in this case the error is not strongly correlated with the matrix
condition number or the relative narrowness of distribution governing
nearest-neighbor distances. I conclude that getting a capacitance error
below 1% using the boundary element method probably requires 10,000’s of
voltage-test points and 10’s of minutes of computation time.</p></li>
<li><p><strong>Study 33</strong> (<a
href="dissipation-theory--Study-33.html">html</a>). Numerically compute
the capacitance of a sphere-tipped cone over a metal using
<em>exactly</em> the method of Xu and co-workers. See Xu, J.; Li, J.;
Li, W. Calculating Electrostatic Interactions in Atomic Force Microscopy
with Semiconductor Samples. AIP Advances (2019) 9(10): 105308, <a
href="https://doi.org/10.1063/1.5110482">doi:10.1063/1.5110482</a>.
Benchmark the method by computing the capacitance, and capacitance
derivatives, of a sphere over a ground plane. This study includes a
lengthy introduction, with references, and a methods section, with
typeset equations. I reproduce Xu’s Fig. 3 plot of force versus
tip-sample separation for a sphere-cone over a metal and, for
comparison, plot the force predicted by my numerical model. To compare
their calculated force to mine, I digitized Xu’s Fig. 3 data using
WebPlotDigitizer. Plotting Xu’s normalized force and my calculated
normalized force versus <span class="math inline">\(h/r\)</span>, I find
that the two calculations agree to within 0.25 percent, a reasonable
number given the finite resolution of the WebPlotDigitizer
program.</p></li>
<li><p><strong>Study 34</strong> (<a
href="dissipation-theory--Study-34.html">html</a>). Numerically compute
BLDS spectra and friction for a cantilever oscillating in the
perpendicular geometry. Plot the (1) BLDS spectrum versus charge density
and scaled charge density; (2) zero-frequency BLDS point versus charge
density and scaled charge density; (3) BLDS roll-off frequency versus
conductivity and dielectric constant; (4) friction versus charge density
and scaled frequency for (a) various dielectric constant imaginary parts
and (b) various mobilities.</p></li>
<li><p><strong>Study 35</strong> (<a
href="dissipation-theory--Study-35.html">html</a>). Numerically compute
Lekkala and Loring’s reaction-field Green’s functions <span
class="math inline">\(K_0\)</span>, <span
class="math inline">\(K_1\)</span>, and <span
class="math inline">\(K_2\)</span> and plot them versus charge location
<span class="math inline">\(z_\mathrm{c}\)</span>, for (1) a metal and
(2) a semiconductor. Show that the metal’s Green’s functions are just
the image-charge potential and are therefore real. Show that the
semiconductor’s Green’s functions differs from the metal’s, and have
imaginary components.</p></li>
<li><p><strong>Study 36</strong> (<a
href="dissipation-theory--Study-36.html">html</a>). Loring has proposed
an energy function for test charges interaction with a semiconductor
sample. The (negative) derivative of this energy function is a force.
Compare Loring’s expression for the force to Xu’s published results, our
calculation of Xu’s results, and the standard Kelvin probe
formula.</p></li>
<li><p><strong>Study 37</strong> (<a
href="dissipation-theory--Study-37.html">html</a>). Compare <span
class="math inline">\(f_2 \: [\mathrm{Hz}/\mathrm{V}^2]\)</span> versus
<span class="math inline">\(h \: [\mathrm{nm}]\)</span> data measured
over gold to calculations employing the following tip models: (a) Two
approximations describing a spherical tip (Loring); (b) Hoepker’s
analytical sphere-plus-cone model; and (c) Marohn’s numerical
sphere-plus-cone model. Perform the fit using Marohn’s numerical
sphere-plus-cone model with the tip radius and cone angle as best-fit
parameters. Conclude that a cone-plus-sphere tip model is required to
fit <span class="math inline">\(f_2\)</span> versus <span
class="math inline">\(h\)</span> data over a metal. Being able to fit
<span class="math inline">\(f_2\)</span> versus <span
class="math inline">\(h\)</span> data to Marohn’s numerical model of a
sphere-plus-cone tip over a metal sample is a significant finding,
because this model can be extended to a semiconductor sample.</p></li>
<li><p><strong>Study 38</strong> (<a
href="dissipation-theory--Study-38.html">html</a>). The code in
<code>dissipation5.py</code> now implements Roger Loring’s revised
theory for the non-contact friction and broadband local dielectric
spectroscopy frequency shift experienced by a charged cantilever,
idealized as a point probe, over a semiconductor. Check that, for an
“infinitely thick” sample, the BLDS frequency shift at <span
class="math inline">\(\omega_{\mathrm{m}} = 0\)</span> has the expected
dependence on charge density and, at <span class="math inline">\(\rho
\rightarrow 0\)</span> and <span class="math inline">\(\rho \rightarrow
\infty\)</span>, agrees with Loring’s analytical limiting-case formulas.
Find that the BLDS frequency shift does not show the expected trend with
scaled charge density.</p></li>
<li><p><strong>Study 39</strong> (<a
href="dissipation-theory--Study-39.html">html</a>). Repeat the Study 34
analysis using <code>dissipation5.py</code> code.</p></li>
<li><p><strong>Study 40</strong> (<a
href="dissipation-theory--Study-40.html">html</a>). Examine closely the
dependence of the <span
class="math inline">\(K_2(\omega_{\mathrm{m}})\)</span> integral on
charge density and dielectric constant. Define a new unitless charge
density <span class="math inline">\(\rho_3\)</span> such that the <span
class="math inline">\(K_2\)</span> integral reaches its half point at
<span class="math inline">\(\rho_3 = 1\)</span>.</p></li>
<li><p><strong>Study 41</strong> (<a
href="dissipation-theory--Study-41.html">html</a>). Repeat Study 34
employing a perovskite-like sample and the <code>dissipation5.py</code>
code, which uses the new Loring formulas for BLDS frequency shift and
non-contact friction. In this study I realize a nice, compact way to
loop over material parameters and generate a composite figure with a
legend; the method does not require much new code.</p></li>
<li><p><strong>Study 42</strong> (<a
href="dissipation-theory--Study-42.html">html</a>). Repeat the Study 39
analysis using Loring’s new 2025-04-17 formulas implemented in the
<code>dissipation6.py</code> code. Find that the BLDS frequency diverges
at high modulation frequency.</p></li>
<li><p><strong>Study 43</strong> (<a
href="dissipation-theory--Study-43.html">html</a>). Representative BLDS
spectra and perpendicular friction plotted versus unitless parameters.
Repeat the Study 39 analysis using Loring’s new 2025-05-14 formulas
implemented in the <code>dissipation7.py</code> code. The new formula
correctly predicts a dc cantilever frequency shift that increases with
increasing charge density (light intensity).</p></li>
<li><p><strong>Study 44</strong> (<a
href="dissipation-theory--Study-44.html">html</a>). Testing new
functions for calculating <span
class="math inline">\(\theta_{I}\)</span>, <span
class="math inline">\(\theta_{II}\)</span>, and <span
class="math inline">\(K_{\ell}\)</span>. Test code for calculating the
functions <span class="math inline">\(\theta_{I}\)</span>, <span
class="math inline">\(\theta_{II}\)</span>, and <span
class="math inline">\(K_{\ell}\)</span>. This notebook tests functions
imported from <code>dissipationtheory8a.py</code> (pure Python) and
<code>dissipationtheory8b.py</code> (numba/jit). These functions are
tested against functions imported from
<code>dissipationtheory7.py</code> (pure Python and numba/jit). In
contrast with the functions in <code>dissipationtheory7.py</code>, the
functions in <code>dissipationtheory8a.py</code> and
<code>dissipationtheory8a.py</code> are well-behaved in the <span
class="math inline">\(\omega \rightarrow 0\)</span> limit. The function
<span class="math inline">\(K_2\)</span> is computed at a selected
position for representative Type I and Type II samples. We show that
<span class="math inline">\(K_0\)</span> computed over a “metallic” Type
I and Type II sample gives the expected unitless image-charge
potential.</p></li>
<li><p><strong>Study 45</strong> (<a
href="dissipation-theory--Study-45.html">html</a>). Test code for
computing friction, <span class="math inline">\(\gamma\)</span>, and
frequency shift, <span class="math inline">\(\Delta
f_{\mathrm{stat}}\)</span> and <span class="math inline">\(\Delta
f_{\mathrm{dyn}}\)</span>, for a cantilever oscillating in the
perpendicular geometry over a thick Type I semiconductor sample. Import
code from <code>dissipationtheory8a.py</code> and
<code>dissipationtheory8b.py</code>. Develop a data class
<code>ExptSweepConductivity</code> which computes and plots friction and
frequency shift for varied conductivity and charge density.</p></li>
<li><p><strong>Study 46</strong> (<a
href="dissipation-theory--Study-46.html">html</a>). Develop code for a
point probe of finite size. Develop code for computing friction, <span
class="math inline">\(\gamma\)</span>, and frequency shift, <span
class="math inline">\(\Delta f\)</span>, for a finite-size tip.
Resources include Loring’s typeset 2025-06-09 notes; Marohn’s
handwritten 2025-06-10, 2025-06-11, 2025-06-12, and 2025-06-14 notes;
code in <code>capacitancefinite.py</code>; and code in Study 30 (<a
href="dissipation-theory--Study-30.html">html</a>), Study 31 (<a
href="dissipation-theory--Study-31.html">html</a>), Study 33 (<a
href="dissipation-theory--Study-33.html">html</a>), and Study 37 (<a
href="dissipation-theory--Study-37.html">html</a>). See Study 41 (<a
href="dissipation-theory--Study-41.html">html</a>) for a compact way to
loop over material parameters and generate a composite figure with a
legend. Here I compute the capacitance (and associated derivatives)
<span class="math inline">\(C_0\)</span>, <span
class="math inline">\(C_1\)</span>, and <span
class="math inline">\(C_2\)</span> of a sphere over a metal ground plane
at various heights using the Xu method and the formalism developed in
the above notes. The resulting code is much more compact and readable
than previously developed code in <code>capacitancefinite.py</code>. The
calculated capacitance and capacitance derivatives show excellent
agreement with analytical series, except for <span
class="math inline">\(C_2\)</span> at large tip-sample separation. I
suspect the problem is that the reference distance of 1 nm is too small,
leading to roundoff error. Examine this hypothesis in a subsequent
notebook.</p></li>
<li><p><strong>Study 47</strong> (<a
href="dissipation-theory--Study-47.html">html</a>). Develop code for a
point probe of finite size (continued). In the previous notebook I
computed the capacitance (and associated derivatives) <span
class="math inline">\(C_0\)</span>, <span
class="math inline">\(C_1\)</span>, and <span
class="math inline">\(C_2\)</span> of a sphere over a metal ground plane
at various heights using the Xu method. The calculated capacitance and
capacitance derivatives showed excellent agreement with analytical
series, except for <span class="math inline">\(C_2\)</span> at large
tip-sample separation. I suspected the problem was that the reference
distance of 1 nm was too small, leading to roundoff error. Below I show
that unless the reference height <span
class="math inline">\(z_{\mathrm{r}}\)</span> is on the order of the
height <span class="math inline">\(h\)</span>, the integral <span
class="math inline">\(K_2(\omega=0, r_1 = [0, 0, h], r_2 = [0, 0,
h])\)</span> will blow up. I believe this finding explains the observed
error in <span class="math inline">\(C_2\)</span> are large <span
class="math inline">\(h\)</span>.</p></li>
<li><p><strong>Study 48</strong> (<a
href="dissipation-theory--Study-48.html">html</a>). Develop code for a
point probe of finite size (continued). Recode the functions in Study 46
(<a href="dissipation-theory--Study-46.html">html</a>) to scale
coordinates by the reference distance <span
class="math inline">\(z_{\mathrm{r}}\)</span> stored in the sample
object. For a spherical tip with radius <span class="math inline">\(r =
30\)</span> nm represented by <span class="math inline">\(N =
15\)</span> image charges, we compute <span
class="math inline">\(C_0\)</span>, <span
class="math inline">\(C_1\)</span>, and <span
class="math inline">\(C_2\)</span> for tip-sample separations spaced
logarithmically between <span class="math inline">\(h = r/2 =
15\)</span> nm and <span class="math inline">\(1 \mu\)</span>m. We
perform this computation for two semi-infinite samples, a “metallic”
sample and a “dielectric” sample having relative dielectric constant 3.
For these two idealized samples, we compare the computed <span
class="math inline">\(C_{j}\)</span>’s to an analytical series solution
approximated by 20 terms. With <span
class="math inline">\(z_{\mathrm{r}} = 0.1\)</span> nm, the agreement is
poor. With <span class="math inline">\(z_{\mathrm{r}} \geq 10\)</span>
nm, the error is only 5 parts per million at <span
class="math inline">\(h = 15\)</span> nm, decreasing to just few parts
per billion at <span class="math inline">\(h = 1 \mu\)</span>m. This
study demonstrates that choosing <span
class="math inline">\(z_{\mathrm{r}}\)</span> appropriately can
dramatically improve the accuracy of the computed capacitance
derivatives, particularly the second derivative <span
class="math inline">\(C_2\)</span>.</p></li>
<li><p><strong>Study 49</strong> (<a
href="dissipation-theory--Study-49.html">html</a>). Develop code for a
point probe of finite size (continued). I have incorporated into
<code>dissipationtheory8c.py</code> the code from Study 48 (<a
href="dissipation-theory--Study-46.html">html</a>) determining the
images charges for a spherical tip. Below I develop code for (a)
computing observables like force, friction, and frequency shift and (b)
determining the image charges for a sphere-plus-cone tip. In contrast
with prior code, read the tip radius, cone angle, and cone length from
the cantilever object.</p></li>
<li><p><strong>Study 50</strong> (<a
href="dissipation-theory--Study-50.html">html</a>). Run finite-tip
simulations. Test drive the code in <code>dissipationtheory8c.py</code>,
comparing the frequency shift measured over gold to that computed using
(1) a sphere and (2) a sphere-plus-cone, both over a Type I “metallic”
sample. Both models predict the size of the frequency shift at small
tip-sample separation <span class="math inline">\(h\)</span> with a
reasonable tip radius and essentially no other free parameters. Model 2
does a better job than Model 1 at predicting the frequency shift at
large <span class="math inline">\(h\)</span>. These computations are
painfully slow. This is because I am modeling the gold substrate as a
Type I sample, essentially a high-conductivity semiconductor, and the
associated response function is very complicated and slow to integrate.
In Study 37 I implimented a sphere-plus-cone frequency shift calculation
using a metal response function, which is much faster to compute. The
Study 37 calculation was fast enough to enable least-squares fitting of
the data to obtain a tip radius and cone angle (this took about a
minute). Below I perform code profiling, brainstorm ways to speed up
data analysis, and explore vector integration.</p></li>
<li><p><strong>Study 51</strong> (<a
href="dissipation-theory--Study-51.html">html</a>). Test and profile the
code in the <code>dissipationtheory9a.py</code>.</p></li>
<li><p><strong>Study 52</strong> (<a
href="dissipation-theory--Study-52.html">html</a>). Test and profile the
code in the <code>dissipationtheory9b.py</code>.</p></li>
<li><p><strong>Study 53</strong> (<a
href="dissipation-theory--Study-53.html">html</a>). Explore writing a
fast <code>twodimCobject</code> object; create fast, compiled
<code>coulombmatrix_jit</code> and <code>Kmatrix_jit</code> functions.
In Study 50 (<a href="dissipation-theory--Study-50.html">html</a>) I
compared the frequency shift measured over gold at 28 tip-sample
separations to the frequency shift computed, using
<code>twodimCobject</code> from <code>dissipationtheory8c.py</code>, for
two tip models, (1) a sphere and (2) a sphere-plus-cone, both over a
Type I “metallic” sample. These computations were painfully slow. For a
<span class="math inline">\(15 \times 30 = 450\)</span> element array,
the <code>twodimCobject.solve</code> function took 4.3 seconds to
execute. It consequently took <em>two minutes</em> to calculate
frequency versus tip-sample separation data, too slow for least-squares
fitting of data to obtain the tip radius and cone angle. The limiting
step in the computation is setting up the Coulomb matrix and the <span
class="math inline">\(K_n\)</span> matrices. Below I develop fast,
compiled functions for setting up these matrices and I benchmark their
execution time for a <span class="math inline">\(15 \times 20 =
300\)</span> element array. These functions are
<code>coulombmatrix_jit</code> (0.2 ms) and <code>Kmatrix_jit</code>
(0.3 ms for metal, 3 ms for Type III sample). Creating a compiled
function to set up the <span class="math inline">\(K_n\)</span> matrices
for a Type III sample required (1) using a newly written
<code>integrand3jit</code> function with simple inputs; (2) replacing
<code>scipy.integrate.quad_vec</code> with a 30-point Newton-Cotes
integration; and (3) writing the function <code>Kmatrix_jit</code>
<em>very</em> carefully so that <code>jit</code> can compile it. Further
work is required to benchmark the Newton-Cotes integration againt
<code>scipy.integrate.quad_vec</code> for a range of sample parameters.
Nevertheless, the new compiled functions suggest that it should be
possible to calculate a frequency shift to experimental accuracy for a
numerically modeled tip in under 1 ms for a metal and in under 20 ms for
a Type I, II, or III semiconductor sample.</p></li>
<li><p><strong>Study 54</strong> (<a
href="dissipation-theory--Study-54.html">html</a>). Write and test a
fast <code>twodimCobject</code> built around <code>KmatrixIII_jit</code>
and <code>KmatrixIV_jit</code>. I find that <code>KmatrixIV_jit</code>
performs well and yields the expected sphere capacitance derivatives. I
find that <code>KmatrixIII_jit</code> performs poorly but can be fixed
by using a different scaling parameter for each matrix element’s
integral. This leads to a breakdown of my paper-and-pencil linear
algebra. So while I can write code to quickly and accurately compute the
<span class="math inline">\(K_n\)</span>’s, I now have to deal with an
explosion of scaling parameters, which my paper-and-pencil solutions do
not presently account for. I need to go back to my paper-and-pencil
linear algebra and work out a fix. (This notebook is a bit of a mess,
with different sections written <em>not</em> in chronological
order.)</p></li>
<li><p><strong>Study 55</strong> (<a
href="dissipation-theory--Study-55.html">html</a>). Optimize
Newton-Cotes integration of the integral <span
class="math inline">\({\cal I}_{2}(x)\)</span> for <span
class="math inline">\(0 \leq x \leq 2\)</span>. The reaction field
matrices <span class="math inline">\(K_{\ell}\)</span> can be written in
terms of a unitless integral <span class="math inline">\({\cal
I}_{\ell}(x)\)</span> given below. The <span
class="math inline">\(x\)</span> variable will likely be limited to the
range <span class="math inline">\(0 \leq x \leq 2\)</span>. Over this
range, optimize the computation of the integral using the Newton-Cotes
method. We find an optimum order <span class="math inline">\(N \sim
30\)</span> and optimum upper integration bound of <span
class="math inline">\(y_{\mathrm{max}} \sim 15\)</span>.</p></li>
<li><p><strong>Study 56</strong> (<a
href="dissipation-theory--Study-56.html">html</a>). Explore a
Fourier-transform based approach to integrating <span
class="math inline">\({\cal I}_{2}(x)\)</span>. The Newton-Cotes
integrator explored previously performs very poorly at <span
class="math inline">\(x \geq 2\)</span>, limiting our calcultions of
frequency shift and friction to tip-sample separation <span
class="math inline">\(h \geq R/4\)</span>, with <span
class="math inline">\(R\)</span> the tip radius. If we had an integrator
working to <span class="math inline">\(x \sim 5\)</span> then we could
perform calculations down to <span class="math inline">\(h \leq
R/10\)</span>, which would be desirable. Here we explore a
Fourier-transform based approach to integrating <span
class="math inline">\({\cal I}_{2}(x)\)</span>. In contrast with the
Newton-Cotes integrator, the FT integrator maintains excellent accuracy
for <span class="math inline">\({\cal I}_{2}(x)\)</span> at large <span
class="math inline">\(x\)</span>, although at the cost of a 7-fold
increase in execution time (from 3 to 21 microseconds per integration).
The FT integrator has horrendous errors for <span
class="math inline">\({\cal I}_{0}(x)\)</span>, however, unless <span
class="math inline">\(N\)</span> is very large, say <span
class="math inline">\(64\)</span>k. Future effort should focus on
getting the Newton-Cotes integrator to work better at large <span
class="math inline">\(x\)</span>, perhaps by breaking the <span
class="math inline">\(y\)</span> axis into subregions informed by our
knowledge of the Bessel-function zeros.</p></li>
<li><p><strong>Study 57</strong> (<a
href="dissipation-theory--Study-57.html">html</a>). An improved
Newton-Cotes integrator for <span class="math inline">\({\cal
I}_{\ell}(x)\)</span> valid at large <span
class="math inline">\(x\)</span>. Here we develop a Newton-Cotes
integrator to calculate <span class="math inline">\({\cal
I}_{\ell}(x)\)</span> accurately at large <span
class="math inline">\(x\)</span>. We achieve this goal by breaking the
integration axis into subregions, informed by our knowledge of the
Bessel-function zeros. The resulting integrator achieves a fractional
error below 20 parts per million for <span class="math inline">\(0 \leq
x \leq 10\)</span>, corresponding to a tip-sample separation of <span
class="math inline">\(R/20 \leq h &lt; \infty\)</span>. The execution
time is reasonably good.</p></li>
<li><p><strong>Study 58</strong> (<a
href="dissipation-theory--Study-58.html">html</a>). Write a fast
<code>twodimCobject</code> object (revisited). Now that I have an
accurate and reasonably fast integrator in place (<a
href="dissipation-theory--Study-57.html">Study 57</a>), let me revisit
writing a fast <code>twodimCobject</code> object for simulating the
capacitance, dissipation, and frequency shift of a finite tip (<a
href="dissipation-theory--Study-53.html">Study 53</a>). Below I develop
code for calculating cantilever observables over a sample consisting of
a semi-infinite metal (Type IV sample) and semi-infinite semiconductor
(Type III sample). The code is a combination of compiled functions and
uncompiled Python. The execution time is reasonably good — 10 ms for a
metallic / Type IV sample and 50 ms for semiconductor / Type III sample.
Accuracy of the code was demonstrated by computing capacitance and
capacitance derivatives versus height, which can be compared to series
solutions for the case of a sphere over a (1) semi-infinite metal sample
and (2) semi-infinite dielectric sample. The relative accuracy was
highly dependent on tip-sample separation and was in the 10’s of part
per million range at experimentally relevant tip-sample
separations.</p></li>
<li><p><strong>Study 59</strong> (<a
href="dissipation-theory--Study-59.html">html</a>). Test drive the new
<code>twodimCobject</code> object. I have moved the code developed in <a
href="dissipation-theory--Study-58.html">Study 58</a> into
<code>dissipation9e.py</code>. Take the new code for a test
drive.</p></li>
<li><p><strong>Study 60</strong> (<a
href="dissipation-theory--Study-60.html">html</a>). Understand and
improve the sphere-plus-cone model in the <code>twodimCobject</code>
object. In
<code>2025-07-10--jam99--20240222-rerun-ringdown-NiOx-U551--Study-1.ipynb</code>
(<a
href="file:///Users/jam99/Dropbox/_JAM_MS__Cohn202407__BLDS/notes-and-scripts/2025-07-10--jam99--20240222-rerun-ringdown-NiOx-U551--Study-1.html">html</a>),
I fit frequency and dissipation data collected versus voltage and
tip-sample separation using a sphere-plus-cone tip model. I found that
the calculated frequency diverged at <em>large</em> tip-sample
separation <span class="math inline">\(h\)</span>. Looking at the image
charges, I observed the two leading tip charges became large and of
oppositite sign at large <span class="math inline">\(h\)</span>. Here I
show that the divergence of the image charges, and the calculated
frequency, can be eliminated by adding a small filtering parameter <span
class="math inline">\(\alpha = 1 \times 10^{-6}\)</span> without
affecting the calculated cantilever frequency significantly.</p></li>
<li><p><strong>Study 61</strong> (<a
href="dissipation-theory--Study-61.html">html</a>). Test drive the new
<code>twodimCobject</code> object in<code>dissipation10e.py</code>.
Augment <code>dissipation9e.py</code> to compute the BLDS spectrum using
Loring’s 07/23/25 pdf report and Marohn’s 08/01/25 handwritten notes.
Create a new <code>twodimCobject</code> object
in<code>dissipation10e.py</code> that computes the cantilever frequency
shift with (1) an AC voltage and (2) an AM-modulated AC voltage applied
to the cantilever tip.</p></li>
<li><p><strong>Study 62</strong> (<a
href="dissipation-theory--Study-62.html">html</a>). Unit testing the
Type III sample computations. In anticipation of adding code to
calculate the frequency shift and dissipation of Type I and Type II
samples, develop unit tests for Type III and Type IV samples. In these
tests we compare the real and imaginary parts of the <span
class="math inline">\(K_n\)</span> integrals (<span
class="math inline">\(n = 0, 1, 2\)</span>) computed using
<code>K_jit</code> in <code>dissipation9b.py</code> to those computed
using <code>KmatrixIII_jit</code> and <code>KmatrixIV_jit</code> in
<code>dissipation10e.py</code>. These unit tests reveal that the
integration scheme in <code>KmatrixIII_jit</code> in
<code>dissipation10e.py</code> has relatively poor accuracy and needs
improvement. Below we develop an improved integration scheme,
<code>KmatrixIII_jit</code> in <code>dissipation11e.py</code>.</p></li>
<li><p><strong>Study 63</strong> (<a
href="dissipation-theory--Study-63.html">html</a>). A new integration
algorithm and more unit testing of Type III sample computations. Unit
testing of the <span class="math inline">\(K_n\)</span> functions
<code>dissipation11e.py</code> revealed that the agreement between the
(fast) new integration scheme in <code>dissipation11e.py</code> and the
(slow) integration scheme in <code>scipy.integrate</code> was
unacceptably poor at low frequency, especially for the imaginary part of
the integral. Here we examine the integrand and devise an improved fast
integration scheme based on a logarithmic change of variables. This new
integration algorithm is coded in <code>dissipation12e.py</code>, with
some preliminary unit tests coded in
<code>test_dissipation12e.py</code>. Below we carry out comprehenvive
unit testing of the <span class="math inline">\(K_n\)</span> functions
by looping over 36288 combinations of the variables <span
class="math inline">\(\boldsymbol{s}_j\)</span>, <span
class="math inline">\(\boldsymbol{r}_k\)</span>, <span
class="math inline">\(\omega\)</span>, <span
class="math inline">\(\epsilon_{\mathrm{s}}\)</span>, <span
class="math inline">\(\rho\)</span>, and <span
class="math inline">\(\sigma\)</span>. Breaking the integrand into 10
sub-intervals, we achieve an rms error in the six (real and imaginary)
<span class="math inline">\(K_1\)</span>, <span
class="math inline">\(K_2\)</span>, and <span
class="math inline">\(K_3\)</span> values of <span
class="math inline">\(\epsilon \leq 0.036\)</span>%. Each integration
takes less than 8 ms.</p></li>
<li><p><strong>Study 64</strong> (<a
href="dissipation-theory--Study-64.html">html</a>). Code up and
unit-test the computation of the <span
class="math inline">\(K_n\)</span> integrals for Type I and Type II
samples. Here we test four new functions in
<code>dissipation13e.py</code> – <code>rpI_jit</code>,
<code>KmatrixI_jit</code>, <code>rpII_jit</code>, and
<code>KmatrixII_jit</code>. We run unit tests over 34k sample
parameters, as in Study 63, comparing <span
class="math inline">\(K_n\)</span> integrals computed using the (slow)
<code>scipy.integrate</code> function in <code>dissipation9b.py</code>
to those computed using the (fast) bespoke integration algorithm in
<code>dissipation13e.py</code>. Using 10 breakpoints in the computation
of the integrals, the root-mean-square error in the <span
class="math inline">\(K_n\)</span> integrals is worse for Type I and
Type II sample than for Type III samples, but is nevertheless below
0.5%. The run time for Type I and II samples is a factor of two longer
than for Type III samples. We conclude that the accuracy and run time of
the Type I and Type II sample <span class="math inline">\(K_n\)</span>
calculations are sufficiently good to warrant analyzing data.</p></li>
<li><p><strong>Study 65</strong> (<a
href="dissipation-theory--Study-65.html">html</a>). We have added Type I
and Type II support to the <code>twodimCobject</code> object in
<code>dissipation13e.py</code>. We demonstrate this functionality by
calculating, for a finite tip, the dc frequency shift and dissipation
versus tip-sample separation and the BLDS spectrum for Type I, II, and
III samples. For 25 height points, the frequency and friction
calculation took (user CPU time) 4.1s, 2.5s, 1.7s, and 4.1s for Type I,
II, and III samples, respectively. Sample I was 15 nm thick and
exhibited a small negative friction, which is unphysical. This error
remained when the number of breakpoints was increased from 15 to 45, and
so is likely not caused by imperfect integration. The error changed with
the <span class="math inline">\(\alpha\)</span> parameter, but using a
larger alpha did not eliminate the negative-friction error. For 40
frequency points, the BLDS spectrum calculation took (user CPU time)
39s, 8.5s, and 7.3s for Type I, II, and III samples, respectively. The
BLDS spectrum for the Type II and Type III sample showed the expected
roll off. The BLDS spectrum from Sample I was negligibly small, but
exhibited two distinct roll-offs.</p></li>
</ul>
</body>
</html>
